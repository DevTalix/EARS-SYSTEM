<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pending Approvals</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
      body { font-family: 'Segoe UI', sans-serif; }
      .sidebar { height: 100vh; background-color: #212529; color: white; padding-top: 1rem; position: fixed; width: 250px; z-index: 1045; }
      .sidebar .nav-link { color: #f8f9fa; font-size: 0.95rem; }
      .sidebar .nav-link:hover, .sidebar .nav-link.active { background-color: #343a40; color: #FFD100; }
      .sidebar i { margin-right: 8px; }
      .content { margin-left: 250px; padding: 2rem; }
      @media (max-width: 991.98px) { .sidebar { display: none; } .content { margin-left: 0; } .mobile-sidebar-toggle { display: block; } }
      @media (min-width: 992px) { .mobile-sidebar-toggle { display: none; } }
      @media (max-width: 575.98px) { .btn { width: 100% !important; margin-bottom: 0.5rem; } .modal-footer .btn { margin-bottom: 0; } }
    </style>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark d-lg-none">
    <div class="container-fluid">
      <button class="btn btn-dark mobile-sidebar-toggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar" aria-controls="mobileSidebar">
        <i class="bi bi-list" style="font-size: 1.5rem;"></i>
      </button>
      <span class="navbar-brand mb-0 h1">Pending Approvals</span>
    </div>
  </nav>
  <div class="sidebar d-none d-lg-flex flex-column">
    <div class="px-3 mb-4"><h5 class="text-warning">Supervisor Menu</h5></div>
    <ul class="nav flex-column px-3">
      <li class="nav-item"><a class="nav-link" href="Dashboard.html"><i class="bi bi-house-door-fill"></i> Dashboard</a></li>
      <li class="nav-item"><a class="nav-link active" href="#"><i class="bi bi-hourglass-split"></i> Pending Approvals</a></li>
      <li class="nav-item"><a class="nav-link" href="ApprovedReports.html"><i class="bi bi-check2-square"></i> Approved Reports</a></li>
      <li class="nav-item"><a class="nav-link" href="Profile.html"><i class="bi bi-person-circle"></i> Profile</a></li>
      <li class="nav-item mt-auto"><a class="nav-link text-danger" href="#"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
    </ul>
  </div>
  <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileSidebar" aria-labelledby="mobileSidebarLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title text-warning" id="mobileSidebarLabel">Supervisor Menu</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
      <ul class="nav flex-column px-3">
        <li class="nav-item"><a class="nav-link" href="Dashboard.html"><i class="bi bi-house-door-fill"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link active" href="#"><i class="bi bi-hourglass-split"></i> Pending Approvals</a></li>
        <li class="nav-item"><a class="nav-link" href="ApprovedReports.html"><i class="bi bi-check2-square"></i> Approved Reports</a></li>
        <li class="nav-item"><a class="nav-link" href="Profile.html"><i class="bi bi-person-circle"></i> Profile</a></li>
        <li class="nav-item mt-auto"><a class="nav-link text-danger" href="#"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
      </ul>
    </div>
  </div>
  <div class="content">
    <h3 class="mb-4">Pending Approvals</h3>
    <!-- Filters -->
    <form class="row mb-3 g-2">
      <div class="col-md-3 mb-2">
        <select class="form-select" id="filterDepartment">
          <option value="">All Departments</option>
          <option value="IT">IT</option>
          <option value="Legal Affairs">Legal Affairs</option>
          <option value="Revenue Collection">Revenue Collection</option>
          <option value="Finance">Finance</option>
        </select>
      </div>
      <div class="col-md-3 mb-2">
        <select class="form-select" id="filterUnit">
          <option value="">All Units</option>
        </select>
      </div>
      <div class="col-md-3 mb-2">
        <select class="form-select" id="filterIntern">
          <option value="">All Interns</option>
        </select>
      </div>
      <div class="col-md-3 mb-2">
        <select class="form-select" id="filterWeek">
          <option value="">All Weeks</option>
          <option>Week 1</option>
          <option>Week 2</option>
          <option>Week 3</option>
          <option>Week 4</option>
        </select>
      </div>
    </form>
    <div class="table-responsive">
      <table class="table table-dark table-hover align-middle">
        <thead>
          <tr>
            <th>Intern Name</th>
            <th>Department</th>
            <th>Unit</th>
            <th>Week</th>
            <th>Submission Date</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Desire</td>
            <td>IT</td>
            <td>Developers</td>
            <td>Week 1</td>
            <td>2024-06-01</td>
            <td><span class="badge bg-warning text-dark">Pending</span></td>
            <td><button class="btn btn-sm btn-primary view-btn" data-intern="Desire" data-department="IT" data-unit="Developers" data-week="Week 1" data-date="2024-06-01" data-content="Report content for Desire, Week 1." data-status="Pending">View</button></td>
          </tr>
          <tr>
            <td>Taliq</td>
            <td>Legal Affairs</td>
            <td>Litigation</td>
            <td>Week 2</td>
            <td>2024-06-02</td>
            <td><span class="badge bg-warning text-dark">Pending</span></td>
            <td><button class="btn btn-sm btn-primary view-btn" data-intern="Taliq" data-department="Legal Affairs" data-unit="Litigation" data-week="Week 2" data-date="2024-06-02" data-content="Report content for Taliq, Week 2." data-status="Pending">View</button></td>
          </tr>
          <tr>
            <td>Norman</td>
            <td>Finance</td>
            <td>Payroll</td>
            <td>Week 1</td>
            <td>2024-06-03</td>
            <td><span class="badge bg-warning text-dark">Pending</span></td>
            <td><button class="btn btn-sm btn-primary view-btn" data-intern="Norman" data-department="Finance" data-unit="Payroll" data-week="Week 1" data-date="2024-06-03" data-content="Report content for Norman, Week 1." data-status="Pending">View</button></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- Report View Modal -->
    <div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="reportModalLabel">Report Details</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label fw-bold">Intern Name:</label>
              <span id="modalInternName">-</span>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Department:</label>
              <span id="modalDepartment">-</span>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Unit:</label>
              <span id="modalUnit">-</span>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Week:</label>
              <span id="modalWeek">-</span>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Submission Date:</label>
              <span id="modalSubmissionDate">-</span>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Report Content:</label>
              <div class="border p-2 bg-light text-dark" id="modalReportContent">-</div>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Status:</label>
              <span id="modalStatus">-</span>
            </div>
            <div class="mb-3 d-none" id="rejectReasonBox">
              <label for="modalRejectReason" class="form-label fw-bold text-danger">Reason for Rejection <span class="text-danger">*</span>:</label>
              <textarea class="form-control border-danger" id="modalRejectReason" rows="2" placeholder="Enter reason for rejection" required></textarea>
            </div>
          </div>
          <div class="modal-footer flex-column flex-sm-row">
            <button type="button" class="btn btn-success" id="approveBtn">Approve</button>
            <button type="button" class="btn btn-danger" id="rejectBtn">Reject</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Department to Units mapping
        const unitsByDept = {
          'IT': ['Developers', 'System Admin', 'Hardware', 'BPU'],
          'Legal Affairs': ['Compliance', 'Litigation'],
          'Revenue Collection': ['Field', 'Office'],
          'Finance': ['Payroll', 'Audit']
        };
        // Department+Unit to Interns mapping
        const internsByDeptUnit = {
          'IT': {
            'Developers': ['Desire'],
            'System Admin': [],
            'Hardware': [],
            'BPU': []
          },
          'Legal Affairs': {
            'Compliance': [],
            'Litigation': ['Taliq']
          },
          'Revenue Collection': {
            'Field': [],
            'Office': []
          },
          'Finance': {
            'Payroll': ['Norman'],
            'Audit': []
          }
        };
        const filterDepartment = document.getElementById('filterDepartment');
        const filterUnit = document.getElementById('filterUnit');
        const filterIntern = document.getElementById('filterIntern');
        function updateUnitOptions() {
          const dept = filterDepartment.value;
          filterUnit.innerHTML = '<option value="">All Units</option>';
          if (dept && unitsByDept[dept]) {
            unitsByDept[dept].forEach(unit => {
              const opt = document.createElement('option');
              opt.value = unit;
              opt.textContent = unit;
              filterUnit.appendChild(opt);
            });
          } else {
            // Show all units if no department selected
            const allUnits = Array.from(new Set(Object.values(unitsByDept).flat()));
            allUnits.forEach(unit => {
              const opt = document.createElement('option');
              opt.value = unit;
              opt.textContent = unit;
              filterUnit.appendChild(opt);
            });
          }
        }
        function updateInternOptions() {
          const dept = filterDepartment.value;
          const unit = filterUnit.value;
          filterIntern.innerHTML = '<option value="">All Interns</option>';
          if (dept && unit && internsByDeptUnit[dept] && internsByDeptUnit[dept][unit]) {
            internsByDeptUnit[dept][unit].forEach(name => {
              const opt = document.createElement('option');
              opt.value = name;
              opt.textContent = name;
              filterIntern.appendChild(opt);
            });
          } else if (dept && internsByDeptUnit[dept]) {
            // All interns in department
            const allInterns = Object.values(internsByDeptUnit[dept]).flat();
            allInterns.forEach(name => {
              const opt = document.createElement('option');
              opt.value = name;
              opt.textContent = name;
              filterIntern.appendChild(opt);
            });
          } else {
            // All interns
            const allInterns = Object.values(internsByDeptUnit).map(units => Object.values(units).flat()).flat();
            allInterns.forEach(name => {
              const opt = document.createElement('option');
              opt.value = name;
              opt.textContent = name;
              filterIntern.appendChild(opt);
            });
          }
        }
        filterDepartment.addEventListener('change', function() {
          updateUnitOptions();
          updateInternOptions();
        });
        filterUnit.addEventListener('change', updateInternOptions);
        updateUnitOptions();
        updateInternOptions();

        const viewBtns = document.querySelectorAll('.view-btn');
        const modalInternName = document.getElementById('modalInternName');
        const modalDepartment = document.getElementById('modalDepartment');
        const modalUnit = document.getElementById('modalUnit');
        const modalWeek = document.getElementById('modalWeek');
        const modalSubmissionDate = document.getElementById('modalSubmissionDate');
        const modalReportContent = document.getElementById('modalReportContent');
        const modalStatus = document.getElementById('modalStatus');
        const reportModal = new bootstrap.Modal(document.getElementById('reportModal'));
        const rejectBtn = document.getElementById('rejectBtn');
        const approveBtn = document.getElementById('approveBtn');
        const rejectReasonBox = document.getElementById('rejectReasonBox');
        const modalRejectReason = document.getElementById('modalRejectReason');
        let rejectMode = false;

        viewBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            modalInternName.textContent = btn.getAttribute('data-intern');
            modalDepartment.textContent = btn.getAttribute('data-department');
            modalUnit.textContent = btn.getAttribute('data-unit');
            modalWeek.textContent = btn.getAttribute('data-week');
            modalSubmissionDate.textContent = btn.getAttribute('data-date');
            modalReportContent.textContent = btn.getAttribute('data-content');
            modalStatus.textContent = btn.getAttribute('data-status');
            rejectReasonBox.classList.add('d-none');
            modalRejectReason.value = '';
            modalRejectReason.classList.remove('is-invalid');
            rejectMode = false;
            reportModal.show();
          });
        });

        rejectBtn.addEventListener('click', function() {
          if (!rejectMode) {
            rejectReasonBox.classList.remove('d-none');
            modalRejectReason.focus();
            rejectMode = true;
          } else {
            if (!modalRejectReason.value.trim()) {
              modalRejectReason.classList.add('is-invalid');
              modalRejectReason.focus();
              return;
            }
            alert('Report rejected with reason: ' + modalRejectReason.value);
            rejectReasonBox.classList.add('d-none');
            modalRejectReason.value = '';
            modalRejectReason.classList.remove('is-invalid');
            rejectMode = false;
            reportModal.hide();
          }
        });
        approveBtn.addEventListener('click', function() {
          alert('Report approved!');
          rejectReasonBox.classList.add('d-none');
          modalRejectReason.value = '';
          modalRejectReason.classList.remove('is-invalid');
          rejectMode = false;
          reportModal.hide();
        });
        document.getElementById('reportModal').addEventListener('hidden.bs.modal', function () {
          rejectReasonBox.classList.add('d-none');
          modalRejectReason.value = '';
          modalRejectReason.classList.remove('is-invalid');
          rejectMode = false;
        });
      });
    </script>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 